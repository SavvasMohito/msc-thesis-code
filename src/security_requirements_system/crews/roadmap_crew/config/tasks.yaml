create_implementation_roadmap:
  description: >
    Based on all the security analysis performed:

    Requirements:
    {requirements_text}

    Security Controls:
    {security_controls}

    Threats:
    {threats}

    Compliance Requirements:
    {compliance_requirements}

    Your goal is to create a comprehensive, prioritized implementation roadmap.

    CRITICAL INSTRUCTIONS:
    1. Define prioritization_criteria:
       - Risk level (from threat modeling)
       - Compliance deadlines and regulatory requirements
       - Technical complexity and dependencies
       - Resource availability
       - Business impact
    
    2. Create implementation phases (typically 4-5 phases):
       a) IMMEDIATE (0-1 months): Critical, high-risk items that must be addressed now
          - Critical vulnerabilities
          - Essential authentication/authorization
          - Basic encryption for sensitive data
          - Compliance blockers
       
       b) SHORT-TERM (1-3 months): High-priority controls that build on immediate work
          - Enhanced authentication (MFA)
          - Comprehensive access controls
          - Security logging and monitoring
          - API security
       
       c) MEDIUM-TERM (3-6 months): Important controls that require more planning
          - Advanced threat detection
          - Security testing automation
          - Third-party security audits
          - Enhanced data protection
       
       d) LONG-TERM (6-12 months): Strategic initiatives and continuous improvement
          - Security maturity enhancements
          - Advanced AI/ML security controls
          - Comprehensive penetration testing
          - Security awareness programs
       
       e) ONGOING: Continuous activities
          - Security monitoring
          - Patch management
          - Compliance audits
          - Incident response readiness
    
    3. For EACH phase, provide:
       - Phase name and timeline
       - Specific security controls to implement
       - Rationale for why these controls are in this phase
       - Dependencies on other phases or external factors
    
    4. Include resource_requirements:
       - Required skills (security engineers, architects, developers, etc.)
       - Recommended tools and technologies
       - Estimated time effort considerations
    
    5. Consider technical dependencies (e.g., must implement authentication before authorization)
    
    6. Output as clean, well-formatted MARKDOWN matching the structure below.
  expected_output: >
    A comprehensive implementation roadmap in MARKDOWN format with the following structure:
    
    IMPORTANT: Output the markdown content directly. DO NOT wrap your output in ```markdown code blocks.
    
    ### 10.1. Prioritization Framework
    
    Provide a comprehensive explanation of the prioritization approach used to organize security controls into implementation phases. 
    Begin with a paragraph explaining why prioritization is critical for effective security implementation, then explain each criterion:
    
    **Prioritization Criteria:**
    
    - **Risk Level**: Controls addressing critical and high-risk threats (identified through threat modeling) are prioritized first
    - **Compliance Deadlines**: Regulatory requirements and compliance deadlines influence immediate priority
    - **Technical Complexity**: Controls requiring foundational infrastructure are implemented early to enable subsequent controls
    - **Dependencies**: Controls that other security measures depend upon are prioritized accordingly
    - **Resource Availability**: Implementation considers the availability of skilled personnel, tools, and budget
    - **Business Impact**: Controls protecting business-critical functions and data receive higher priority
    
    Explain how these criteria work together to create a logical implementation sequence that balances security needs with practical constraints.
    
    ### 10.2. Phased Implementation Plan
    
    For EACH phase, create a subsection (####):
    
    #### Phase: IMMEDIATE
    
    **Timeline:** 0-1 months
    
    **Rationale:** [Why these controls are in this phase]
    
    **Controls to Implement:**

    - Control 1
    - Control 2
    - Control 3
    
    **Dependencies:**

    - Dependency 1
    - Dependency 2
    (Only include if there are dependencies)
    
    Example:
    #### Phase: SHORT-TERM
    
    **Timeline:** 1-3 months
    
    **Rationale:** These controls build upon immediate security measures, focusing on improving access control adjustments and ensuring that logging and API security mitigate identified threats effectively.
    
    **Controls to Implement:**

    - Enhance user authentication through comprehensive multi-factor authentication
    - Deploy role-based access controls across the admin dashboard
    - Implement comprehensive logging and monitoring for all administrative actions
    - Strengthen API security with input validation and HTTPS protocols
    - Begin encryption for all sensitive data at rest
    
    **Dependencies:**

    - Completion of TLS Implementation
    - Completion of multi-factor authentication
    
    ### 10.3. Resource Requirements
    
    A paragraph or structured text covering skills, tools, and estimated time effort.
    
    Example:
    "Skills: Security engineers, Security architects, Web developers, Compliance specialists; Recommended tools: SIEM solutions for logging and monitoring, Vulnerability scanners for testing, Encryption libraries for data protection, API management tools for secure interfaces; Estimated time effort: Approximately 3-6 months for initial phases, with ongoing efforts extending resources as per system complexity and requirements."
  agent: implementation_planner

