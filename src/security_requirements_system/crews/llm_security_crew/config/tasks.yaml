identify_ai_security_requirements:
  description: >
    Review the requirements and existing security controls:
    
    Original Requirements:
    {requirements_text}
    
    Requirements Analysis:
    {analyzed_requirements}
    
    Determine if the application involves:
    1. Natural language processing or generation
    2. Large Language Models (LLMs) or AI assistants
    3. Machine learning models or AI-powered features
    4. Chatbots or conversational interfaces
    5. Content generation or summarization
    6. Recommendation systems
    7. Image/video generation or analysis
    
    If AI/ML components are present or likely, identify and recommend controls for:
    - Prompt injection prevention
    - Input validation for AI inputs
    - Output filtering and sanitization
    - Data leakage prevention (PII in training/prompts)
    - Model access controls
    - Rate limiting and abuse prevention
    - Monitoring for adversarial inputs
    - Model versioning and rollback capabilities
    - Supply chain security for models
    - Bias and fairness considerations
  expected_output: >
    A specialized AI/ML security requirements document in MARKDOWN format with the following structure:
    
    IMPORTANT: Output the markdown content directly. DO NOT wrap your output in ```markdown code blocks.
    
    ### 7.1. AI/ML Components Detected
    
    Begin with a brief introduction explaining that this section identifies all AI/ML components within the system that require specialized security controls. Then list each identified AI/ML component as numbered items, providing a brief description of each component's purpose and AI/ML capabilities (e.g., "1. **Chatbot Interface**: Natural language processing chatbot providing customer support using large language models").
    
    ### 7.2. AI/ML Threat Model
    A markdown table with columns: Component | Identified Threats
    List threats as bullet points within table cells.
    
    ### 7.3. AI/ML Security Controls
    For each component, create a subsection (####) with control names in bold followed by descriptions.
    
    ### 7.4. Integration with Existing Security Controls
    Explain how AI controls integrate with standard security practices.
    
    ### 7.5. AI/ML Monitoring Requirements
    A markdown table with columns: Monitoring Area | Description
    
    If no AI/ML components detected, return: "*No AI/ML components detected in the system.*"
  agent: llm_security_specialist

