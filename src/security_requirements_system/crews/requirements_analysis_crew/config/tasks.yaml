analyze_requirements:
  description: >
    Analyze the following product manager requirements:

    {requirements_text}

    Your goal is to perform a comprehensive requirements analysis including detailed breakdown,
    security context, assumptions, and constraints.

    CRITICAL INSTRUCTIONS:
    1. Write a concise, one-paragraph summary of the application's main purpose.
    2. Decompose the requirements into a list of specific features (high_level_requirements).
       Each item should represent a distinct capability of the system.
       - Example: "User registration and login with multi-factor authentication"
       - Example: "A searchable product catalog with detailed item descriptions"
    3. For EACH high-level requirement, create a detailed analysis (detailed_requirements):
       - Assign a unique ID (REQ-001, REQ-002, etc.)
       - Categorize by business function (e.g., Authentication, Data Management, Payment Processing)
       - Assess security sensitivity (High, Medium, Low)
       - Determine data classification (Public, Internal, Confidential, Restricted)
       - Provide rationale for why this requirement exists
    4. Provide security_context: identify applicable regulations and compliance obligations
       based on the domain (e.g., HIPAA for healthcare, PCI-DSS for payments, GDPR for EU data)
    5. List key assumptions about the system (e.g., "System will be cloud-hosted", "Users have internet access")
    6. List technical and operational constraints (e.g., "Must integrate with legacy EHR systems")
    7. Ensure the output is a valid JSON object matching the AnalysisOutput schema.
  expected_output: >
    A comprehensive JSON object matching the AnalysisOutput schema with all optional fields populated.
  agent: requirements_analyst

analyze_architecture:
  description: >
    Based on the following product manager requirements:

    {requirements_text}

    Your goal is to create a comprehensive system architecture analysis.

    CRITICAL INSTRUCTIONS:
    1.  Write a brief, one-paragraph summary of the proposed system architecture.
        Describe the main components (e.g., frontend, backend, database) and how they interact.
    2.  Generate a Mermaid diagram (using `graph TD` syntax) to visually represent the architecture.
    3.  For EACH major component, provide detailed analysis (components):
        - Component name
        - Its responsibility/purpose
        - Security criticality (Critical, High, Medium, Low)
        - External dependencies (APIs, third-party services)
        - Types of data it handles
    4.  Describe data_flow_description: how data moves through the system, where it's stored,
        and key transformation points.
    5.  Identify trust_boundaries: different trust zones in the system (e.g., "Internet", "DMZ", 
        "Internal Network", "Database Tier") and the security controls protecting each boundary.
    6.  Provide attack_surface_analysis: entry points, exposed APIs, user interfaces,
        integration points, and their associated risk levels.
    7.  Ensure the output is a valid JSON object matching the ArchitectureOutput schema.
  expected_output: >
    A comprehensive JSON object matching the ArchitectureOutput schema with all optional fields populated.
  agent: system_architect

